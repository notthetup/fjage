
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Directory Services &#8212; fjåge 1.4.1 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distributed Agents" href="remote.html" />
    <link rel="prev" title="Messaging" href="messages.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="remote.html" title="Distributed Agents"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="messages.html" title="Messaging"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">fjåge 1.4.1 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Directory Services</a><ul>
<li><a class="reference internal" href="#advertising-services">Advertising services</a></li>
<li><a class="reference internal" href="#looking-up-service-providers">Looking up service providers</a></li>
<li><a class="reference internal" href="#caching-service-providers">Caching service providers</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="messages.html"
                        title="previous chapter">Messaging</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="remote.html"
                        title="next chapter">Distributed Agents</a></p>
<div id="searchbox" style="overflow:hidden;">
<script>
  (function() {
    var cx = '006023374622006758365:siprl0efik0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<h3>Search</h3>
<gcse:search></gcse:search>
</div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="directory-services">
<h1>Directory Services<a class="headerlink" href="#directory-services" title="Permalink to this headline">¶</a></h1>
<div class="section" id="advertising-services">
<h2>Advertising services<a class="headerlink" href="#advertising-services" title="Permalink to this headline">¶</a></h2>
<p>It is often undesirable to hardcode names of agents that we need to interact with. Directory services provide a simple mechanism to advertise services provided by an agent, and to find agents that provide specific services. A <em>service</em> is a contract between two agents, and usually defined by a set of messages and possibly behaviors.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">A <em>service</em> is a logical concept, and not enforced by the framework. The messages and behaviors represented by a service are not described in the code. However, it is recommended that the documentation associated with the service clearly spell out the messages and behaviors that are expected of any agent claiming to provide the service.</p>
</div>
<p>An agent providing a service usually advertises the service during <cite>init()</cite>:</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">MyServer</span> <span class="kd">extends</span> <span class="n">org</span><span class="o">.</span><span class="na">arl</span><span class="o">.</span><span class="na">fjage</span><span class="o">.</span><span class="na">Agent</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">register</span> <span class="s1">&#39;WeatherForecastService&#39;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Rather than use a <cite>String</cite>, we may (and usually should) use an Enum to define the service:</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="kd">enum</span> <span class="n">Services</span> <span class="o">{</span>
  <span class="n">WEATHER_FORECAST_SERVICE</span><span class="o">,</span>
  <span class="n">CLEANING_SERVICE</span><span class="o">,</span>
  <span class="n">FOOD_DELIVERY_SERVICE</span>
<span class="o">}</span>
</pre></div>
</div>
<p>and then use it to advertise our services:</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">MyServer</span> <span class="kd">extends</span> <span class="n">org</span><span class="o">.</span><span class="na">arl</span><span class="o">.</span><span class="na">fjage</span><span class="o">.</span><span class="na">Agent</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">register</span> <span class="n">Services</span><span class="o">.</span><span class="na">WEATHER_FORECAST_SERVICE</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="looking-up-service-providers">
<h2>Looking up service providers<a class="headerlink" href="#looking-up-service-providers" title="Permalink to this headline">¶</a></h2>
<p>A client interested in availing a specific service can look for an agent that provides the service:</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="kt">def</span> <span class="n">weatherStation</span> <span class="o">=</span> <span class="n">agentForService</span> <span class="n">Services</span><span class="o">.</span><span class="na">WEATHER_FORECAST_SERVICE</span>
<span class="kt">def</span> <span class="n">rsp</span> <span class="o">=</span> <span class="n">weatherStation</span> <span class="o">&lt;&lt;</span> <span class="k">new</span> <span class="n">WeatherForecastReq</span><span class="o">(</span><span class="nl">city:</span> <span class="s1">&#39;London&#39;</span><span class="o">,</span> <span class="nl">country:</span> <span class="s1">&#39;UK&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>If there are more than one agents providing the service, the <cite>agentForService()</cite> method returns any one of the service providers. If we wish to get a list of all service providers, we can use the <cite>agentsForService()</cite> method instead:</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="kt">def</span> <span class="n">providerList</span> <span class="o">=</span> <span class="n">agentsForService</span> <span class="n">Services</span><span class="o">.</span><span class="na">WEATHER_FORECAST_SERVICE</span>
</pre></div>
</div>
</div>
<div class="section" id="caching-service-providers">
<h2>Caching service providers<a class="headerlink" href="#caching-service-providers" title="Permalink to this headline">¶</a></h2>
<p>If your application uses a set of agents that are instantiated in the <cite>initrc.groovy</cite> and not terminated until the application terminates, it may be reasonable to lookup the service providers once and cache them once and for all. However, since the services are only advertised during agent initialization and the order of agent intialization may be indeterminate, the service lookups should be done after all agents are initialized (and not during <cite>init()</cite>). This can easily be accomplished using a one-shot behavior:</p>
<div class="highlight-groovy"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">MyClient</span> <span class="kd">extends</span> <span class="n">org</span><span class="o">.</span><span class="na">arl</span><span class="o">.</span><span class="na">fjage</span><span class="o">.</span><span class="na">Agent</span> <span class="o">{</span>
  <span class="kt">def</span> <span class="n">weatherStation</span>
  <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">add</span> <span class="k">new</span> <span class="nf">OneShotBehavior</span><span class="o">({</span>
      <span class="n">weatherStation</span> <span class="o">=</span> <span class="n">agentForService</span> <span class="n">Services</span><span class="o">.</span><span class="na">WEATHER_FORECAST_SERVICE</span>
    <span class="o">})</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As long as the agents are added to the container before starting the platform, fjåge guarantees that all agents are initialized before any agent behaviors are called.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="remote.html" title="Distributed Agents"
             >next</a></li>
        <li class="right" >
          <a href="messages.html" title="Messaging"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">fjåge 1.4.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013, Mandar Chitre.
    </div>
  </body>
</html>